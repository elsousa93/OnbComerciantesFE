<form [formGroup]="formNewStakeholder" (ngSubmit)="submit()" autocomplete="true">
  <div class="container-fluid mt-0 ms-0 me-0 pt-0 ps-0 pe-0">
    <div class="row">
      <div class="row ms-0 me-0" *ngIf="currentStakeholder != null" #selectedBlueDiv id="selectedBlueDiv">
        <div class="col-6 ms-0 me-0 ps-0 pe-5">
          <p class="titulo-form-simples mb-1" *ngIf="currentStakeholder?.stakeholderAcquiring?.signType != null && currentStakeholder?.stakeholderAcquiring?.signType !== ''">{{'stakeholder.signature'|translate}}:*</p>
          <nav class="navbar navbar-expand-lg navbar-light bg-light" *ngIf="currentStakeholder?.stakeholderAcquiring?.signType != null && currentStakeholder?.stakeholderAcquiring?.signType !== ''">
            <span class="navbar-text">
              <div class="form-check">
                <input class="form-check-input" formControlName="contractAssociation" name="contractAssociation"
                       type="radio" value="true" id="contractAssociation" />
                <label class="form-check-label radio pe-5">{{'generalKeywords.yes'|translate|uppercase}}</label>
              </div>
            </span>
            <span class="navbar-text">
              <div class="form-check">
                <input class="form-check-input" formControlName="contractAssociation" name="contractAssociation"
                       type="radio" value="false" id="contractAssociation" />
                <label class="form-check-label radio">{{'generalKeywords.no'|translate|uppercase}}</label>
              </div>
            </span>
          </nav>
          <div class="alert alert-danger"
               *ngIf="formNewStakeholder.get('contractAssociation').touched && !formNewStakeholder.get('contractAssociation').valid">
            <div *ngIf="formNewStakeholder.get('contractAssociation').errors && formNewStakeholder.get('contractAssociation').errors?.['required']">
              {{'generalKeywords.mandatoryParameter'|translate}}
            </div>
          </div>
          <p class="titulo-form-simples mb-1" *ngIf="currentStakeholder?.stakeholderAcquiring?.signType != null && currentStakeholder?.stakeholderAcquiring?.signType !== '' && !currentStakeholder?.stakeholderAcquiring['isCorporate']" >
            {{'citizenCard.updateData'|translate|uppercase}}*
          </p>
          <nav class="navbar navbar-expand-lg navbar-light bg-light" *ngIf="currentStakeholder?.stakeholderAcquiring?.signType != null && currentStakeholder?.stakeholderAcquiring?.signType !== '' && !currentStakeholder?.stakeholderAcquiring['isCorporate']" >
            <span class="navbar-text">
              <div class="form-check">
                <input class="form-check-input" formControlName="flagRecolhaEletronica" name="flagRecolhaEletronica"
                       type="radio" [value]=true id="flagRecolhaEletronica" [checked]="flagRecolhaEletronica"
                       [attr.disabled]="(flagRecolhaEletronica || returned === 'consult') ? true : null"
                       (click)="validateCC(true)" />
                <label class="form-check-label radio pe-5">{{'generalKeywords.yes'|translate|uppercase}}</label>
              </div>
            </span>
            <span class="navbar-text">
              <div class="form-check">
                <input input class="form-check-input" formControlName="flagRecolhaEletronica"
                       name="flagRecolhaEletronica" type="radio" [value]=false id="flagRecolhaEletronica"
                       [attr.disabled]="(flagRecolhaEletronica || returned === 'consult') ? true : null"
                       (click)="validateCC(false)" />
                <label class="form-check-label radio">{{'generalKeywords.no'|translate|uppercase}}</label>
              </div>
            </span>
          </nav>
          <div class="alert alert-danger"
               *ngIf="formNewStakeholder.get('flagRecolhaEletronica').touched && !formNewStakeholder.get('flagRecolhaEletronica').valid">
            <div *ngIf="formNewStakeholder.get('flagRecolhaEletronica').errors && formNewStakeholder.get('flagRecolhaEletronica').errors?.['required']">
              {{'generalKeywords.mandatoryParameter'|translate}}
            </div>
          </div>
          <p class="titulo-form-simples"></p>

          <div *ngIf="isCC" class="titulo-form-simples">
            {{'citizenCard.readClick'|translate}} <br>
            <button type="button" class="btn botao_azul_pesquisa mb-3"
                    (click)="openModal(template)">
              {{'citizenCard.read'|translate}}
            </button>
            <div *ngIf="okCC">
              <div class="row me-0">
                <div class="col">
                  <div class="me-0 ps-0 pe-0 col-7 mb-5">
                    <p class="titulo-form-simples">
                      {{'citizenCard.documentCountry'|translate}}:* <span>
                      </span>
                    </p>
                    <input class="form-control campo_form" id="countryCC" value="{{countryCC}}" type="text" [disabled]="true">
                  </div>
                </div>
              </div>
              <table class="table table-sm table-light">
                <thead>
                  <tr class="titulo-form-simples">
                    {{'citizenCard.readData'|translate|uppercase}}
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row" class="titulo-form-simples">{{'citizenCard.name'|translate}}:</th>
                    <td>{{dataCCcontents.nameCC}}</td>
                  </tr>
                  <tr>
                    <th scope="row" class="titulo-form-simples">{{'citizenCard.ccNumber'|translate}}:</th>
                    <td>{{dataCCcontents.cardNumberCC}}</td>
                  </tr>
                  <tr>
                    <th scope="row" class="titulo-form-simples">NIF:</th>
                    <td>{{dataCCcontents.nifCC}}</td>
                  </tr>
                  <tr>
                    <th scope="row" class="titulo-form-simples">{{'citizenCard.address'|translate}}:</th>
                    <td>{{dataCCcontents.addressCC}}</td>
                  </tr>
                  <tr>
                    <th scope="row" class="titulo-form-simples">{{'citizenCard.postalCode'|translate}}:</th>
                    <td>{{dataCCcontents.postalCodeCC}}</td>
                  </tr>
                  <tr>
                    <th scope="row" class="titulo-form-simples">{{'citizenCard.birthDate'|translate}}:</th>
                    <td>{{dataCCcontents.birthdateCC}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

        </div>
        <div class="offset-1 ms-0 me-0 ps-5 pe-0 col-6">
          <p class="titulo-form-simples mb-3" *ngIf="currentStakeholder?.stakeholderAcquiring?.signType != null && currentStakeholder?.stakeholderAcquiring?.signType !== ''">{{'stakeholder.proxy'|translate}}:*</p>
          <nav class="navbar navbar-expand-lg navbar-light bg-light" *ngIf="currentStakeholder?.stakeholderAcquiring?.signType != null && currentStakeholder?.stakeholderAcquiring?.signType !== ''">
            <span class="navbar-text">
              <div class="form-check">
                <input class="form-check-input" formControlName="proxy" name="proxy" type="radio" value="true"
                       id="proxy" [attr.disabled]="returned === 'consult' ? true : null" (change)="changeProxy(true)"/>
                <label class="form-check-label radio pe-5">{{'generalKeywords.yes'|translate|uppercase}}</label>
              </div>
            </span>
            <span class="navbar-text">
              <div class="form-check">
                <input class="form-check-input" formControlName="proxy" name="proxy" type="radio" value="false"
                       id="proxy" [attr.disabled]="returned === 'consult' ? true : null" (change)="changeProxy(false)"/>
                <label class="form-check-label radio">{{'generalKeywords.no'|translate|uppercase}}</label>
              </div>
            </span>
          </nav>
          <div class="alert alert-danger"
               *ngIf="formNewStakeholder.get('proxy').touched && !formNewStakeholder.get('proxy').valid">
            <div *ngIf="formNewStakeholder.get('proxy').errors && formNewStakeholder.get('proxy').errors?.['required']">
              {{'generalKeywords.mandatoryParameter'|translate}}
            </div>
          </div>
        </div>
        <div class="row" *ngIf="!showYesCC && showNoCC">
          <div class="col-6" id="nif">
            <div class="row">
              <p class="titulo-form-simples">
                {{(((currentStakeholder?.stakeholderAcquiring?.signType != null && currentStakeholder?.stakeholderAcquiring?.signType !== '') || !currentStakeholder?.stakeholderAcquiring['isCorporate']) ? 'NIF *' : 'NIPC *')}}
                <span class="titulo-form-error" *ngIf="incorrectNIF" class="titulo-form-simples-erro">
                  {{'client.incorrectNIF'|translate}}
                </span>
                <span class="titulo-form-error" *ngIf="incorrectNIFSize"
                      class="titulo-form-simples-erro">
                  {{'client.incorrectNIFSize'|translate}}
                </span>
                <span class="titulo-form-error" *ngIf="incorrectNIPCSize"
                      class="titulo-form-simples-erro">
                  {{'client.incorrectNIPCSize'|translate}}
                </span>
                <span class="titulo-form-error" *ngIf="incorrectNIPC" class="titulo-form-simples-erro">
                  {{'client.incorrectNIPC'|translate}}
                </span>
              </p>
              <input tabindex="1" #NIF id="fiscalId" class="form-control" type="text" (keyup)="validate(NIF.value)" (keypress)="numericOnlyNIF($event)" formControlName="NIF" [readonly]="currentStakeholder?.stakeholderAcquiring?.fiscalId != null && currentStakeholder?.stakeholderAcquiring?.fiscalId != ''">
            </div>
          </div>
        </div>
        <div class="row" *ngIf="!showYesCC && showNoCC">
          <div class="col-6">
            <div class="row">
              <p class="titulo-form-simples">{{'stakeholder.country'|translate|uppercase}} *</p>
              <select tabindex="2" class="form-select campo-form-select" formControlName="Country"
                      (click)="clean()" [attr.disabled]="(returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 ')) ) ? true : null">
                <option *ngFor="let country of countries" value="{{country.code}}">
                  {{country.description}}
                </option>
              </select>
              <div class="alert alert-danger"
                   *ngIf="formNewStakeholder.get('Country').touched && !formNewStakeholder.get('Country').valid">
                <div *ngIf="formNewStakeholder.get('Country').errors && formNewStakeholder.get('Country').errors?.['required']">
                  {{'generalKeywords.mandatoryParameter'|translate}}
                </div>
              </div>
            </div>
            <div class="row">
              <p class="titulo-form-simples">{{'stakeholder.address'|translate|uppercase}} *</p>
              <input tabindex="4" class="form-control" type="text" formControlName="Address" autocomplete="true"
                     [attr.disabled]="(returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 ')) ) ? true : null">
              <div class="alert alert-danger"
                   *ngIf="formNewStakeholder.get('Address').touched && !formNewStakeholder.get('Address').valid">
                <div *ngIf="formNewStakeholder.get('Address').errors && formNewStakeholder.get('Address').errors?.['required']">
                  {{'generalKeywords.mandatoryParameter'|translate}}
                </div>
              </div>
            </div>
          </div>
          <div class="col-6">
            <div class="row ms-0">
              <p class="titulo-form-simples">{{'stakeholder.postalCode'|translate|uppercase}} *</p>
              <input tabindex="3" class="form-control" type="text" formControlName="ZIPCode" (focusout)="onFocusOut()"
                     (keyup)="GetCountryByZipCode($event)" (keypress)="numericOnly($event)" maxlength="8" autocomplete="true"
                     [attr.disabled]="(returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 ')) ) ? true : null">
              <div class="alert alert-danger"
                   *ngIf="formNewStakeholder.get('ZIPCode').touched && !formNewStakeholder.get('ZIPCode').valid">
                <div *ngIf="formNewStakeholder.get('ZIPCode').errors && (formNewStakeholder.get('ZIPCode').errors?.['required'] || formNewStakeholder.get('ZIPCode').errors?.['minlength'] || formNewStakeholder.get('ZIPCode').errors?.['maxlength'])">
                  {{'generalKeywords.mandatoryParameter'|translate}}
                </div>
              </div>
            </div>
            <div class="row ms-0">
              <p class="titulo-form-simples">{{'stakeholder.locale'|translate|uppercase}} *</p>
              <input tabindex="5" class="form-control" type="text" formControlName="Locality" autocomplete="true"
                     [readonly]="canEditLocality() === false || returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 '))">
              <div class="alert alert-danger"
                   *ngIf="formNewStakeholder.get('Locality').touched && !formNewStakeholder.get('Locality').valid">
                <div *ngIf="formNewStakeholder.get('Locality').errors && formNewStakeholder.get('Locality').errors?.['required']">
                  {{'generalKeywords.mandatoryParameter'|translate}}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="showYesCC && !showNoCC">
          <div class="col-6">
            <p class="titulo-form-simples mt-0">NIF</p>
            <input id="fiscalId" class="form-control campo_form" type="text" formControlName="NIF"
                   [readonly]="true">
          </div>
          <!--<div class="col-6">
            <p class="titulo-form-simples mt-0">{{'stakeholder.role'|translate|uppercase}}</p>
            <select id="roleStakeholder" class="form-select campo-form-select" formControlName="Role"
              [attr.disabled]="(selectedStakeholderIsFromCRC === true && currentStakeholder.stakeholderAcquiring.fiscalId != null) ? true : null">-->
          <!-- antes era chamado o método canEditRole()-->
          <!--<option *ngFor="let role of stakeholdersRoles" value="{{role.code}}">{{role.description}}</option>
            </select>
          </div>-->
        </div>
        <div class="row" *ngIf="showYesCC && !showNoCC">
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'citizenCard.identificationDocumentType'|translate}}:*</p>
            <input readonly name="documentType" formControlName="documentType"
                   class="form-control campo_form">
          </div>
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'citizenCard.identificationDocumentNumber'|translate}}:*</p>
            <input readonly name="identificationDocumentId" formControlName="identificationDocumentId"
                   class="form-control campo_form">
          </div>
        </div>
        <div class="row" *ngIf="showYesCC && !showNoCC">
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'citizenCard.identificationDocumentCountry'|translate}}:*</p>
            <select disabled name="identificationDocumentCountry" formControlName="identificationDocumentCountry"
                    class="form-control campo_form"> <!--readonly-->
              <option *ngFor="let country of countries" value={{country.code}}
                      [attr.selected]="(currentStakeholder?.stakeholderAcquiring?.identificationDocument?.country == country.code) ? true : null">
                {{country.description}}
              </option>
            </select>
          </div>
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'citizenCard.identificationDocumentDate'|translate}}:*</p>
            <input readonly name="identificationDocumentValidUntil" formControlName="identificationDocumentValidUntil"
                   cols="30" rows="10" class="form-control campo_form">
          </div>
        </div>
        <div class="row" *ngIf="showYesCC && !showNoCC">
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'stakeholder.country'|translate|uppercase}}</p>
            <select class="form-select campo-form-select" formControlName="Country"
                    (click)="clean()" [attr.disabled]="(returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 '))) ? true : null">
              <option *ngFor="let country of countries" value="{{country.code}}">
                {{country.description}}
              </option>
            </select>
            <div class="alert alert-danger"
                 *ngIf="formNewStakeholder.get('Country').touched && !formNewStakeholder.get('Country').valid">
              <div *ngIf="formNewStakeholder.get('Country').errors && formNewStakeholder.get('Country').errors?.['required']">
                {{'generalKeywords.mandatoryParameter'|translate}}
              </div>
            </div>
          </div>
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'stakeholder.locale'|translate|uppercase}}</p>
            <input class="form-control campo_form" type="text" autocomplete="true"
                   formControlName="Locality" [readonly]="canEditLocality() === false || returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 '))">
            <div class="alert alert-danger"
                 *ngIf="formNewStakeholder.get('Locality').touched && !formNewStakeholder.get('Locality').valid">
              <div *ngIf="formNewStakeholder.get('Locality').errors && formNewStakeholder.get('Locality').errors?.['required']">
                {{'generalKeywords.mandatoryParameter'|translate}}
              </div>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="showYesCC && !showNoCC">
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'stakeholder.postalCode'|translate|uppercase}}</p>
            <input class="form-control campo_form" type="text" formControlName="ZIPCode"
                   (keyup)="GetCountryByZipCode()" (keypress)="numericOnly($event)" maxlength="8" autocomplete="true"
                   [attr.disabled]="(returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 '))) ? true : null">
            <div class="alert alert-danger"
                 *ngIf="formNewStakeholder.get('ZIPCode').touched && !formNewStakeholder.get('ZIPCode').valid">
              <div *ngIf="formNewStakeholder.get('ZIPCode').errors && formNewStakeholder.get('ZIPCode').errors?.['required']">
                {{'generalKeywords.mandatoryParameter'|translate}}
              </div>
            </div>
          </div>
          <div class="col-6">
            <p class="titulo-form-simples mt-0">{{'stakeholder.address'|translate|uppercase}}</p>
            <input class="form-control campo_form" type="text" autocomplete="true"
                   formControlName="Address" [attr.disabled]="(returned === 'consult' || (returned == null && (currentStakeholder?.stakeholderAcquiring?.identificationDocument?.type == '0018 '))) ? true : null">
            <div class="alert alert-danger"
                 *ngIf="formNewStakeholder.get('Address').touched && !formNewStakeholder.get('Address').valid">
              <div *ngIf="formNewStakeholder.get('Address').errors && formNewStakeholder.get('Address').errors?.['required']">
                {{'generalKeywords.mandatoryParameter'|translate}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
<ng-template #template>
  <main class="container-fluid bg-primary ms-0 me-0 ps-0 pe-0" style="margin-top: 0px !important;">
    <div class="container-fluid ms-0 me-0 pt-2 pb-2 ps-2 pe-2">
      <div class="row justify-content-center mt-0 ms-2 me-0 pt-0 pb-0 ps-0 pe-0">
        <div class="align-self-center ms-0 me-0 pt-0 pb-0 ps-0 pe-0 col-12">
          <nav class="navbar navbar-expand navbar-light bg-primary mt-0 mb-0 ms-0 me-0 pt-0 pb-0 ps-0 pe-0">
            <span class="navbar-text ms-auto align-self-start">
              <h2 class="text-light mt-1 mb-0 ms-0 me-1 pt-0 pb-0 ps-0 pe-4" style="cursor: pointer;"
                  (click)="modalRef.hide()">
                x
              </h2>
            </span>
          </nav>
        </div>
        <div class="row mb-5 ms-0 me-0 ps-0 pe-0">
          <div class="mb-5 ps-0 pe-0 col-12">
            <nav class="navbar navbar-expand-lg navbar-light justify-content-center bg-primary mt-0 mb-0 pt-0 pb-0">
              <span class="navbar-text"></span>
              <span class="material-symbols-rounded img_badge">
                <img src="assets/images/badge.svg" class="img_badge">
              </span>
            </nav>
            <nav class="navbar navbar-expand-lg navbar-light justify-content-center bg-primary mt-0 mb-0 pt-0 pb-0 text-center">
              <span class="navbar-text">
                <h5 class="text-light mb-2 pt-lg-4 pb-lg-5 ps-lg-4 pe-lg-4">
                  {{'citizenCard.addressPIN'|translate}}
                </h5>
              </span>
            </nav>
            <nav class="navbar navbar-expand-lg navbar-light justify-content-center pt-0 pb-0 bg-primary">
              <span class="navbar-text"></span>
              <span class="navbar-text pb-0 pt-sm-0">
                <button id="btn5a"
                        class="btn boto_alerta_modal mt-4 mb-0 ms-3 me-3 pt-3 pb-3 ps-4 pe-4 ps-lg-4 pe-lg-4"
                        style="color: white;" wappler-command="editContent" data-bs-dismiss="modal"
                        (click)="modalRef.hide(); callreadCCAddress()">
                  {{'generalKeywords.yes'|translate|uppercase}}
                </button>
              </span>
              <span class="navbar-text pt-0 pb-0">
                <button id="btn5a1"
                        class="btn boto_alerta_modal mb-sm-0 mt-4 mb-0 ms-3 me-3 pt-3 pb-3 ps-4 pe-4 ps-lg-4 pe-lg-4"
                        style="color: white;" wappler-command="editContent"
                        (click)="modalRef.hide(); callreadCC(); setAddressFalse()">
                  {{'generalKeywords.no'|translate|uppercase}}
                </button>
              </span>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </main>
</ng-template>

